<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ElasticSearch on Promise</title>
    <link>https://blog.zkilm.cn/tags/elasticsearch/</link>
    <description>Recent content in ElasticSearch on Promise</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-hans</language>
    <copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright>
    <lastBuildDate>Wed, 01 Sep 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.zkilm.cn/tags/elasticsearch/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ç™¾ä¸‡çº§æ•°æ®å¯¼å…¥ Elasticsearch ğŸ˜Œ</title>
      <link>https://blog.zkilm.cn/posts/2021/20210901-python-es/</link>
      <pubDate>Wed, 01 Sep 2021 00:00:00 +0000</pubDate>
      
      <guid>https://blog.zkilm.cn/posts/2021/20210901-python-es/</guid>
      <description>æ¶‰åŠçŸ¥è¯†ç‚¹  Python è¯»å–CSVæ–‡ä»¶ Elasticsearch å¯¼å…¥jsonæ–‡ä»¶  æœ¬æ–‡ç›®æ ‡  å®Œæˆè¶…è¿‡100Mçš„SCVæ–‡ä»¶ä¸Šä¼ åˆ°ES  å¯¼è¯­ å¦‚ä½•å°†100wæ¡è®°å½•åŒæ­¥åˆ°Esï¼Ÿ
Kibana æœ‰ä¸ª Data Visualizer å¯ä»¥ç›´æ¥ä¸Šä¼  CSV æ–‡ä»¶ï¼Œä½†æ˜¯æœ‰ä¸ªé™åˆ¶æ˜¯æ–‡ä»¶ä¸èƒ½å¤§äº100Mã€‚
é‚£ä¹ˆå¯¹äºå¤§äº100Mçš„ CSV æ–‡ä»¶æˆ‘ä»¬è¯¥å¦‚ä½•è¿›è¡Œä¸Šä¼ åˆ°ESå‘¢ï¼Ÿ
æˆ‘è¿™é‡Œé‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡Esçš„ Bulk API è¿›è¡Œå¯¼å…¥ã€‚
å‚è€ƒåœ°å€ï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html
ä½†æ˜¯ Bulk API å¯¹ä¸Šä¼ çš„JSONæ–‡ä»¶å¤§å°ä¹Ÿä¼šæœ‰é™åˆ¶ï¼Œé™åˆ¶ä¸º50Mï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¯¹JSONæ–‡ä»¶è¿›è¡Œæ‹†åˆ†ï¼Œä¿è¯æ¯ä¸ªå•JSONæ–‡ä»¶ä¸è¶…è¿‡50Mã€‚
æ•´ä½“åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤ï¼š
æ­¥éª¤ä¸€ï¼šå¯¹æ€»CSVæ–‡ä»¶è¿›è¡Œjsonæ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–ä¸ºæŒ‡å®šçš„jsonæ ¼å¼ï¼Œéœ€è¦ç¬¦åˆBulk APIçš„ä¸Šä¼ è¦æ±‚ æ­¥éª¤äºŒï¼šå¯¹jsonæ–‡ä»¶è¿›è¡Œæ‹†åˆ†å­˜å‚¨ï¼Œä¿è¯å•jsonæ–‡ä»¶å¤§å°ä¸è¶…è¿‡50M Pyè„šæœ¬ Python ä»£ç å¦‚ä¸‹(test.py)ï¼š
import csv from collections import defaultdict, OrderedDict import json import time import argparse import os parser = argparse.ArgumentParser(description=&amp;#39;è‡ªå®šä¹‰CLIä¼ å‚&amp;#39;) parser.add_argument(&amp;#39;--csv_filename&amp;#39;, &amp;#39;-cf&amp;#39;, help=&amp;#39;csv_filename é€‰å–æŒ‡å®šCSVæ–‡ä»¶åï¼Œå¿…è¦å‚æ•°&amp;#39;, required=True) parser.add_argument(&amp;#39;--json_dirname&amp;#39;, &amp;#39;-jd&amp;#39;, help=&amp;#39;json_dirname å°†ä½œä¸ºJSONæ–‡ä»¶ç›®å½•åï¼Œå¿…è¦å‚æ•°&amp;#39;, required=True) args = parser.parse_args() start_time=time.</description>
    </item>
    
    <item>
      <title>Elasticsearch åœ¨ Laravel ä¸­çš„ä½¿ç”¨ğŸ‘</title>
      <link>https://blog.zkilm.cn/posts/2021/20210823-laravel-es/</link>
      <pubDate>Mon, 23 Aug 2021 00:00:00 +0000</pubDate>
      
      <guid>https://blog.zkilm.cn/posts/2021/20210823-laravel-es/</guid>
      <description>æœ¬æ–‡ç›®æ ‡  å­¦ä¼šåœ¨ Laravel ä¸­å®‰è£… Elasticsearchã€‚ åˆ›å»ºç´¢å¼•ã€‚ ç®€å•æŸ¥è¯¢ã€‚  å®‰è£… composer åŒ… composer require elasticsearch/elasticsearch &amp;#39;~7.0&amp;#39; é…ç½® config/database.php # Elasticsearch Config Info &amp;#39;elasticsearch&amp;#39; =&amp;gt; [ // Elasticsearch æ”¯æŒå¤šå°æœåŠ¡å™¨è´Ÿè½½å‡è¡¡ï¼Œå› æ­¤è¿™é‡Œæ˜¯ä¸€ä¸ªæ•°ç»„  &amp;#39;hosts&amp;#39; =&amp;gt; explode(&amp;#39;,&amp;#39;, env(&amp;#39;ES_HOSTS&amp;#39;)), &amp;#39;username&amp;#39; =&amp;gt; env(&amp;#39;ES_USERNAME&amp;#39;), &amp;#39;password&amp;#39; =&amp;gt; env(&amp;#39;ES_PASSWORD&amp;#39;), ], åˆå§‹åŒ– Elasticsearch å¯¹è±¡ // æ³¨å†Œä¸€ä¸ªåä¸º es çš„å•ä¾‹ $this-&amp;gt;app-&amp;gt;singleton(&amp;#39;es&amp;#39;, function () { // ä»é…ç½®æ–‡ä»¶è¯»å– Elasticsearch æœåŠ¡å™¨åˆ—è¡¨  $builder = ESClientBuilder::create()-&amp;gt;setHosts(config(&amp;#39;database.elasticsearch.hosts&amp;#39;)) -&amp;gt;setBasicAuthentication(config(&amp;#39;database.elasticsearch.username&amp;#39;),config(&amp;#39;database.elasticsearch.password&amp;#39;)); // å¦‚æœæ˜¯å¼€å‘ç¯å¢ƒ  if (app()-&amp;gt;environment() === &amp;#39;local&amp;#39;) { // é…ç½®æ—¥å¿—ï¼ŒElasticsearch çš„è¯·æ±‚å’Œè¿”å›æ•°æ®å°†æ‰“å°åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•  $builder-&amp;gt;setLogger(app(&amp;#39;log&amp;#39;)-&amp;gt;driver()); } return $builder-&amp;gt;build(); }); åˆ›å»ºç´¢å¼• curl -XPUT -u name:pwd http://ip:9200/user_behavior?</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨Elasticsearchåšå¼•æ“ï¼ŒScoutå…¨æ–‡æœç´¢ğŸ”</title>
      <link>https://blog.zkilm.cn/posts/2019/20190308-laravel-elasticsearch/</link>
      <pubDate>Fri, 08 Mar 2019 00:00:00 +0000</pubDate>
      
      <guid>https://blog.zkilm.cn/posts/2019/20190308-laravel-elasticsearch/</guid>
      <description>ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨ã€‚å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿
 å‡†å¤‡ 1ã€å®‰è£…æµ‹è¯•Laravel5.5ç”¨äºæµ‹è¯•
composer create-project --prefer-dist laravel/laravel test &amp;#34;5.5.*&amp;#34; 2ã€å®‰è£…è¿è¡Œes é“¾æ¥åœ°å€ï¼Œç‚¹å¼€é“¾æ¥ï¼Œæ ¹æ®è‡ªå·±çš„ç³»ç»Ÿä¸‹è½½å®‰è£…åŒ…ï¼Œé‡Œé¢å…³äºæ€ä¹ˆæ ·å®‰è£…è¿è¡Œéƒ½è¯´çš„æ¯”è¾ƒæ¸…æ¥šã€‚ä¸‹è½½åè§£å‹ã€‚ç”±äºæˆ‘ç”¨çš„æ˜¯Homesteadç¯å¢ƒï¼Œè‡ªå¸¦äº†esã€‚
cd elasticsearch-6.4.2 //è¿›å…¥åˆ°è§£å‹ç›®å½• ./bin/elasticsearch //æœ¬åœ°è¿è¡Œes  Homesteadç¯å¢ƒ  sudo systemctl restart elasticsearch.service //å¯åŠ¨ curl http://127.0.0.1:9200/ //æ£€æµ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ sudo /usr/share/elasticsearch/bin/elasticsearch-plugin list //æŸ¥çœ‹elasticsearch-analysis-ik ä¸­æ–‡åˆ†è¯æ’ä»¶ sudo systemctl disable elasticsearch.service //å…³é—­ Elasticsearch å¼€æœºå¯åŠ¨ å¼€å§‹ 1ã€è¿›å…¥é¡¹ç›®ç›®å½•
cd test 2ã€å®‰è£…Laravel scout å…¨æ–‡æœç´¢åŒ…
composer require laravel/scout=5.0 æ³¨æ„ï¼šå®‰è£…5.0ç‰ˆæœ¬éœ€è¦åšå¦‚ä¸‹ä¿®æ”¹ï¼š
 /vendor/laravel/scout/src/Searchable.php æœ‰ä¸€ä¸ªgetScoutModelsByIds()æ–¹æ³•çš„è¿™æ®µä»£ç æ³¨é‡Šæ‰å°±å¯ä»¥äº†ã€‚  if ($builder-&amp;gt;queryCallback) { call_user_func($builder-&amp;gt;queryCallback, $query); }   å°†laravel/scout 5.0.0ç‰ˆæœ¬æ¢æˆ laravel/scout 5.0.3å³å¯è§£å†³Undefined property: Laravel\Scout\Builder::$queryCallbackæŠ¥é”™é—®é¢˜ã€‚ä¸ç”¨æ‰‹åŠ¨ä¿®æ”¹æºç ã€‚</description>
    </item>
    
  </channel>
</rss>
