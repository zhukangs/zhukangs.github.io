<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>PhpOffice on Promise</title>
    <link>https://blog.gookm.cn/tags/phpoffice/</link>
    <description>Recent content in PhpOffice on Promise</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-hans</language>
    <copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright>
    <lastBuildDate>Thu, 21 Mar 2019 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.gookm.cn/tags/phpoffice/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>PHPOfficeä¹‹WordğŸ­â€</title>
      <link>https://blog.gookm.cn/posts/2019/20190321-phpoffice-word/</link>
      <pubDate>Thu, 21 Mar 2019 00:00:00 +0000</pubDate>
      
      <guid>https://blog.gookm.cn/posts/2019/20190321-phpoffice-word/</guid>
      <description>å¯¼è¯­ åœ¨åšå®Œæ ¹æ®Excelæ¨¡æ¿å¯¼å‡ºæ•°æ®åï¼Œå°±å¯¹Wordæ¨¡æ¿å¯¼å‡ºäº§ç”Ÿäº†å…´è¶£ã€‚å…¶å®åŸç†å·®ä¸å¤šã€‚æ‰€ä»¥è¿˜æ˜¯é€‰æ‹©çš„PHPOffice å¥—é¤ã€‚
PHPWordæ˜¯ä¸€ä¸ªç”¨çº¯PHPç¼–å†™çš„åº“ï¼Œå®ƒæä¾›äº†ä¸€ç»„ç”¨äºå†™å…¥å’Œè¯»å–ä¸åŒæ–‡æ¡£æ–‡ä»¶æ ¼å¼çš„ç±»ã€‚å½“å‰ç‰ˆæœ¬çš„PHPWordæ”¯æŒMicrosoft Office Open XMLï¼ˆOOXMLæˆ–OpenXMLï¼‰ï¼ŒOfficeåº”ç”¨ç¨‹åºçš„OASIS Open Document Formatï¼ˆOpenDocumentæˆ–ODFï¼‰å’ŒRTFæ ¼å¼ï¼ˆRTFï¼‰ã€‚
PHPWordæ–‡æ¡£ä¼ é€é—¨
å¼€å§‹ å®‰è£… composer require phpoffice/phpword ä½¿ç”¨ æ‹¿åˆ°åŸå§‹çš„æ¨¡æ¿è¿˜éœ€è¦åšä¸€äº›ç®€å•çš„ä¿®æ”¹ï¼š ä»£ç  &amp;lt;?php namespace App\Http\Controllers; use Illuminate\Http\Request; use PhpOffice\PhpWord\PhpWord; use PhpOffice\PhpWord\TemplateProcessor; class TestController extends Controller { . . //Word public function wordExport(Request $request) { $template = new TemplateProcessor(public_path().&amp;#39;/phpoffice/word_temp.docx&amp;#39;); //è®¾ç½®æ›¿æ¢å€¼ ï¼ˆåªèƒ½æ›¿æ¢çº¯æ–‡æœ¬ï¼‰ $template-&amp;gt;setValue( [&amp;#39;Name&amp;#39;,&amp;#39;Date&amp;#39;,&amp;#39;Address&amp;#39;,&amp;#39;Organizer&amp;#39;,&amp;#39;Activity&amp;#39;], [$request-&amp;gt;name,$request-&amp;gt;start_time,$request-&amp;gt;address,$request-&amp;gt;organizer,$request-&amp;gt;activity] ); $filename = date(&amp;#39;Y-m-d&amp;#39;, time()).rand(1000, 9999). &amp;#34;.docx&amp;#34;; //ä¿å­˜åˆ°é¡¹ç›® $template-&amp;gt;saveAs(public_path().&amp;#39;/phpoffice/&amp;#39;.$filename); //å»ºè®®ï¼šå°†æ•°æ®[&amp;#39;Name&amp;#39;,&amp;#39;Date&amp;#39;,&amp;#39;Address&amp;#39;,&amp;#39;Organizer&amp;#39;,&amp;#39;Activity&amp;#39;]å†™ä¸€ä»½åˆ°æ•°æ®åº“ //TODO return back()-&amp;gt;with([&amp;#39;success&amp;#39;=&amp;gt;&amp;#39;å¯¼å‡ºæˆåŠŸ&amp;#39;,&amp;#39;filename&amp;#39;=&amp;gt;$filename]); } } æ•ˆæœ ç»“æŸè¯­ ç›®å‰æ˜¯å°†æ–‡ä»¶ä¿å­˜åœ¨äº†é¡¹ç›®ï¼Œæƒ³è¦å®‰å…¨ç‚¹å¯ä»¥ä¸¢åˆ°Storageæ–‡ä»¶å¤¹ä¸‹æˆ–è€…ä¸Šä¼ è‡³cosï¼Œoosï¼Œä¸ƒç‰›ç­‰ã€‚ç›´æ¥è¾“å‡ºåˆ°æµè§ˆå™¨æš‚æ—¶è¿˜æ²¡æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚
ä¸åŠªåŠ›ï¼Œä½ èƒŒäº•ç¦»ä¹¡å¹²å˜›ï¼ï¼ŸåŠ æ²¹ï¼ğŸ’ª</description>
    </item>
    
    <item>
      <title>PHPOfficeä¹‹ExcelğŸœ</title>
      <link>https://blog.gookm.cn/posts/2019/20190320-phpoffice-excel/</link>
      <pubDate>Wed, 20 Mar 2019 00:00:00 +0000</pubDate>
      
      <guid>https://blog.gookm.cn/posts/2019/20190320-phpoffice-excel/</guid>
      <description>å¯¼è¯­ ç®€å•çš„æ•°æ®å¯¼å…¥å¯¼å‡ºå…¶å® Maatwebsite/Laravel-Excel å’Œ box/spout å°±å¤Ÿäº†ï¼Œå¬è¯´spoutåœ¨å¤§é‡æ•°æ®ä¸‹æ•ˆç‡è¾ƒLaravel-Excel å¿«ã€‚è¿™æ¬¡å› ä¸ºè¦æ ¹æ®Excelæ¨¡æ¿å¯¼å‡ºï¼Œåœ¨è¿™ä¸¤ä¸ªåŒ…æ²¡æ‰¾åˆ°æ€ä¹ˆå¼•å…¥æ¨¡æ¿çš„æ–¹æ³•ï¼Œè™½ç„¶å¯ä»¥è®¾ç½®ï¼Œä½†æ˜¯è¿‡äºéº»çƒ¦ï¼Œå°±æ”¾å¼ƒäº†ã€‚æœ€ç»ˆé€‰æ‹©äº† PHPOffice/PhpSpreadsheet ã€‚
PhpSpreadsheetæ˜¯ä¸€ä¸ªç”¨çº¯PHPç¼–å†™çš„åº“ï¼Œå®ƒæä¾›äº†ä¸€ç»„ç±»ï¼Œå…è®¸æ‚¨è¯»å–å’Œå†™å…¥ä¸åŒçš„ç”µå­è¡¨æ ¼æ–‡ä»¶æ ¼å¼ï¼Œå¦‚Excelå’ŒLibreOffice Calcã€‚
PhpSpreadsheetæ–‡æ¡£ä¼ é€é—¨
å®‰è£… composer require phpoffice/phpspreadsheet ä½¿ç”¨ &amp;lt;?php namespace App\Http\Controllers; use Illuminate\Http\Request; use App\Models\TreasureLog; use Carbon\Carbon; use Illuminate\Support\Facades\Auth; use PhpOffice\PhpSpreadsheet\Spreadsheet; use PhpOffice\PhpSpreadsheet\Writer\Xlsx; //å¯ä»¥ç”Ÿæˆå¤šç§æ ¼å¼ç±» use PhpOffice\PhpSpreadsheet\IOFactory; use PhpOffice\PhpSpreadsheet\Style\Alignment; use PhpOffice\PhpSpreadsheet\Style\Border; class TestController extends Controller{ . . public function excelExport() { $rows=TreasureLog::select(&amp;#39;id&amp;#39;,&amp;#39;user_id&amp;#39;,&amp;#39;product_id&amp;#39;,&amp;#39;product_name&amp;#39;,&amp;#39;type&amp;#39;,&amp;#39;coin_type&amp;#39;)-&amp;gt;limit(100)-&amp;gt;get()-&amp;gt;toArray(); //é€šè¿‡å·¥å‚æ¨¡å¼åˆ›å»ºå†…å®¹ $spreadsheet = IOFactory::load(public_path().&amp;#39;/phpoffice/biser.xlsx&amp;#39;); $worksheet = $spreadsheet-&amp;gt;getActiveSheet(); $worksheet-&amp;gt;setCellValue(&amp;#39;B8&amp;#39;,rand(100000,999999)); $worksheet-&amp;gt;setCellValue(&amp;#39;B9&amp;#39;,Carbon::now()); $worksheet-&amp;gt;setCellValue(&amp;#39;B10&amp;#39;,Auth::user()-&amp;gt;name); $num=12; foreach ($rows as $row){ $num++; $worksheet-&amp;gt;setCellValue(&amp;#39;A&amp;#39;.$num,$row[&amp;#39;id&amp;#39;]); $worksheet-&amp;gt;setCellValue(&amp;#39;B&amp;#39;.$num,$row[&amp;#39;user_id&amp;#39;]); $worksheet-&amp;gt;setCellValue(&amp;#39;D&amp;#39;.$num,$row[&amp;#39;product_id&amp;#39;]); $worksheet-&amp;gt;setCellValue(&amp;#39;F&amp;#39;.$num,$row[&amp;#39;product_name&amp;#39;]); $worksheet-&amp;gt;setCellValue(&amp;#39;H&amp;#39;.</description>
    </item>
    
  </channel>
</rss>
