<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Python on Promise</title>
    <link>https://hugo.zkilm.cn/tags/python/</link>
    <description>Recent content in Python on Promise</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-hans</language>
    <copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright>
    <lastBuildDate>Wed, 01 Sep 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://hugo.zkilm.cn/tags/python/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ç™¾ä¸‡çº§æ•°æ®å¯¼å…¥ Elasticsearch ğŸ˜Œ</title>
      <link>https://hugo.zkilm.cn/posts/20210901-python-es/</link>
      <pubDate>Wed, 01 Sep 2021 00:00:00 +0000</pubDate>
      
      <guid>https://hugo.zkilm.cn/posts/20210901-python-es/</guid>
      <description>æ¶‰åŠçŸ¥è¯†ç‚¹  Python è¯»å–CSVæ–‡ä»¶ Elasticsearch å¯¼å…¥jsonæ–‡ä»¶  æœ¬æ–‡ç›®æ ‡  å®Œæˆè¶…è¿‡100Mçš„SCVæ–‡ä»¶ä¸Šä¼ åˆ°ES  å¯¼è¯­ å¦‚ä½•å°†100wæ¡è®°å½•åŒæ­¥åˆ°Esï¼Ÿ
Kibana æœ‰ä¸ª Data Visualizer å¯ä»¥ç›´æ¥ä¸Šä¼  CSV æ–‡ä»¶ï¼Œä½†æ˜¯æœ‰ä¸ªé™åˆ¶æ˜¯æ–‡ä»¶ä¸èƒ½å¤§äº100Mã€‚
é‚£ä¹ˆå¯¹äºå¤§äº100Mçš„ CSV æ–‡ä»¶æˆ‘ä»¬è¯¥å¦‚ä½•è¿›è¡Œä¸Šä¼ åˆ°ESå‘¢ï¼Ÿ
æˆ‘è¿™é‡Œé‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡Esçš„ Bulk API è¿›è¡Œå¯¼å…¥ã€‚
å‚è€ƒåœ°å€ï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html
ä½†æ˜¯ Bulk API å¯¹ä¸Šä¼ çš„JSONæ–‡ä»¶å¤§å°ä¹Ÿä¼šæœ‰é™åˆ¶ï¼Œé™åˆ¶ä¸º50Mï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¯¹JSONæ–‡ä»¶è¿›è¡Œæ‹†åˆ†ï¼Œä¿è¯æ¯ä¸ªå•JSONæ–‡ä»¶ä¸è¶…è¿‡50Mã€‚
æ•´ä½“åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤ï¼š
æ­¥éª¤ä¸€ï¼šå¯¹æ€»CSVæ–‡ä»¶è¿›è¡Œjsonæ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–ä¸ºæŒ‡å®šçš„jsonæ ¼å¼ï¼Œéœ€è¦ç¬¦åˆBulk APIçš„ä¸Šä¼ è¦æ±‚ æ­¥éª¤äºŒï¼šå¯¹jsonæ–‡ä»¶è¿›è¡Œæ‹†åˆ†å­˜å‚¨ï¼Œä¿è¯å•jsonæ–‡ä»¶å¤§å°ä¸è¶…è¿‡50M Pyè„šæœ¬ Python ä»£ç å¦‚ä¸‹(test.py)ï¼š
import csv from collections import defaultdict, OrderedDict import json import time import argparse import os parser = argparse.ArgumentParser(description=&amp;#39;è‡ªå®šä¹‰CLIä¼ å‚&amp;#39;) parser.add_argument(&amp;#39;--csv_filename&amp;#39;, &amp;#39;-cf&amp;#39;, help=&amp;#39;csv_filename é€‰å–æŒ‡å®šCSVæ–‡ä»¶åï¼Œå¿…è¦å‚æ•°&amp;#39;, required=True) parser.add_argument(&amp;#39;--json_dirname&amp;#39;, &amp;#39;-jd&amp;#39;, help=&amp;#39;json_dirname å°†ä½œä¸ºJSONæ–‡ä»¶ç›®å½•åï¼Œå¿…è¦å‚æ•°&amp;#39;, required=True) args = parser.parse_args() start_time=time.</description>
    </item>
    
  </channel>
</rss>
