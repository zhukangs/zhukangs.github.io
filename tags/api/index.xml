<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>API on Promise</title>
    <link>https://blog.gookm.cn/tags/api/</link>
    <description>Recent content in API on Promise</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-hans</language>
    <copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright>
    <lastBuildDate>Sat, 05 Mar 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.gookm.cn/tags/api/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Laravel ä½¿ç”¨JWT API æˆæƒğŸš€</title>
      <link>https://blog.gookm.cn/posts/2022/20220305-api-jwt/</link>
      <pubDate>Sat, 05 Mar 2022 00:00:00 +0000</pubDate>
      
      <guid>https://blog.gookm.cn/posts/2022/20220305-api-jwt/</guid>
      <description>ä»€ä¹ˆæ˜¯JWT Json web token (JWT), æ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´ä¼ é€’å£°æ˜è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäºJSONçš„å¼€æ”¾æ ‡å‡†ï¼ˆ(RFC 7519).è¯¥tokenè¢«è®¾è®¡ä¸ºç´§å‡‘ä¸”å®‰å…¨çš„ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç«™ç‚¹çš„å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰åœºæ™¯ã€‚JWTçš„å£°æ˜ä¸€èˆ¬è¢«ç”¨æ¥åœ¨èº«ä»½æä¾›è€…å’ŒæœåŠ¡æä¾›è€…é—´ä¼ é€’è¢«è®¤è¯çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œä»¥ä¾¿äºä»èµ„æºæœåŠ¡å™¨è·å–èµ„æºï¼Œä¹Ÿå¯ä»¥å¢åŠ ä¸€äº›é¢å¤–çš„å…¶å®ƒä¸šåŠ¡é€»è¾‘æ‰€å¿…é¡»çš„å£°æ˜ä¿¡æ¯ï¼Œè¯¥tokenä¹Ÿå¯ç›´æ¥è¢«ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯è¢«åŠ å¯†ã€‚ä½œè€…ï¼šDearmadmané“¾æ¥ï¼šhttps://www.jianshu.com/p/576dbf44b2aeæ¥æºï¼šç®€ä¹¦è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
å…³äºJWTè®²è§£ä¸åˆ†æï¼šhttps://learnku.com/articles/17883
å®‰è£… composer å®‰è£… lcobucci/jwt ï¼Œæˆ‘è¿™é‡Œé»˜è®¤å®‰è£…çš„æ˜¯æœ€æ–°ç‰ˆ 4.1 ã€‚
composer require lcobucci/jwt å°è£… åœ¨ app\Helpers ç›®å½•ä¸‹æ–°å»º Jwt.php æ–‡ä»¶ï¼Œå°è£… Jwt ç±»ã€‚
&amp;lt;?php /** * Created by PhpStorm. * User: zhukang * Date: 2019/8/22 * Time: 16:39 */ namespace App\Helpers; use Illuminate\Support\Facades\Redis; use Lcobucci\Clock\SystemClock; use Lcobucci\JWT\Configuration; use Lcobucci\JWT\Exception; use Lcobucci\JWT\Signer\Hmac\Sha256; use Lcobucci\JWT\Signer\Key\InMemory; use Lcobucci\JWT\Token\Plain; use Lcobucci\JWT\Validation\Constraint\IdentifiedBy; use Lcobucci\JWT\Validation\Constraint\IssuedBy; use Lcobucci\JWT\Validation\Constraint\PermittedFor; use Lcobucci\JWT\Validation\Constraint\SignedWith; use Lcobucci\JWT\Validation\Constraint\ValidAt; use Lcobucci\JWT\Validation\RequiredConstraintsViolated; trait Jwt { protected $issuedBy;//ç­¾å‘äºº protected $permittedFor;//å—ä¼— protected $identifiedBy;//jwtç¼–å· protected $issuedAt;//ç­¾å‘æ—¶é—´ protected $expiresAt;//è¿‡æœŸæ—¶é—´ protected $jwt_secret; //ç§˜é’¥ public function __construct() { //è·å–jwté…ç½®ä¿¡æ¯ $jwt_configs = config(&amp;#39;jwt&amp;#39;); $this-&amp;gt;issuedBy = $jwt_configs[&amp;#39;issuedBy&amp;#39;]; $this-&amp;gt;permittedFor = $jwt_configs[&amp;#39;permittedFor&amp;#39;]; $this-&amp;gt;identifiedBy = $jwt_configs[&amp;#39;identifiedBy&amp;#39;]; $this-&amp;gt;issuedAt = $jwt_configs[&amp;#39;issuedAt&amp;#39;]; $this-&amp;gt;expiresAt = $this-&amp;gt;issuedAt-&amp;gt;modify($jwt_configs[&amp;#39;expiresAt&amp;#39;]); $this-&amp;gt;jwt_secret = $jwt_configs[&amp;#39;jwt_secret&amp;#39;]; } /** * @Description:ç”Ÿæˆjwté…ç½®å¯¹è±¡ * @return Configuration * @Author:zhukang * @Date:2022/4/7 16:05 */ public function createJwtObject() { return Configuration::forSymmetricSigner( new Sha256(), InMemory::base64Encoded($this-&amp;gt;jwt_secret) ); } /** * @Description:ç”Ÿæˆtoken * @param array $bind éœ€è¦åœ¨jwtè½½ä½“(payload)ä¸­åŠ å…¥çš„æ•°æ® [&amp;#39;userid&amp;#39;=&amp;gt;1,&amp;#39;xxxx&amp;#39;=&amp;gt;xxxx] * @return string \Lcobucci\JWT\Token * @Author:zhukang * @Date:2022/4/7 16:04 */ public function getToken(array $bind = []) { $jwt_object = $this-&amp;gt;createJwtObject(); $jwt_obj = $jwt_object-&amp;gt;builder() -&amp;gt;issuedBy($this-&amp;gt;issuedBy) -&amp;gt;permittedFor($this-&amp;gt;permittedFor) -&amp;gt;identifiedBy($this-&amp;gt;identifiedBy) -&amp;gt;issuedAt($this-&amp;gt;issuedAt) -&amp;gt;canOnlyBeUsedAfter($this-&amp;gt;issuedAt) -&amp;gt;expiresAt($this-&amp;gt;expiresAt); if (is_array($bind) &amp;amp;&amp;amp; !</description>
    </item>
    
    <item>
      <title>Laravel ä½¿ç”¨ Sanctum API æˆæƒ</title>
      <link>https://blog.gookm.cn/posts/2022/20220218-api-sanctum/</link>
      <pubDate>Fri, 18 Feb 2022 00:00:00 +0000</pubDate>
      
      <guid>https://blog.gookm.cn/posts/2022/20220218-api-sanctum/</guid>
      <description>ä»‹ç» Laravel Sanctum ä¸º SPAï¼ˆå•é¡µåº”ç”¨ç¨‹åºï¼‰ã€ç§»åŠ¨åº”ç”¨ç¨‹åºå’ŒåŸºäºä»¤ç‰Œçš„ã€ç®€å•çš„ API æä¾›è½»é‡çº§èº«ä»½éªŒè¯ç³»ç»Ÿã€‚Sanctum å…è®¸åº”ç”¨ç¨‹åºçš„æ¯ä¸ªç”¨æˆ·ä¸ºä»–ä»¬çš„å¸æˆ·ç”Ÿæˆå¤šä¸ª API ä»¤ç‰Œã€‚è¿™äº›ä»¤ç‰Œå¯ä»¥è¢«æˆäºˆæŒ‡å®šå…è®¸ä»¤ç‰Œæ‰§è¡Œå“ªäº›æ“ä½œçš„èƒ½åŠ› / èŒƒå›´ã€‚
ç›¸å…³æ–‡æ¡£ï¼šhttps://learnku.com/docs/laravel/9.x/sanctum/12272
å®‰è£… å®‰è£… Laravel Sanctum
composer require laravel/sanctum Artisan å‘½ä»¤å‘å¸ƒ Sanctum çš„é…ç½®å’Œè¿ç§»æ–‡ä»¶
php artisan vendor:publish --provider=&amp;#34;Laravel\Sanctum\SanctumServiceProvider&amp;#34; Sanctum å°†åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¡¨æ¥å­˜å‚¨ API ä»¤ç‰Œ
php artisan migrate å°† Sanctum çš„ä¸­é—´ä»¶æ·»åŠ åˆ°æ‚¨åº”ç”¨çš„ app/Http/Kernel.php æ–‡ä»¶ä¸­çš„ api ä¸­é—´ä»¶ç»„ä¸­
&amp;#39;api&amp;#39; =&amp;gt; [ \Laravel\Sanctum\Http\Middleware\EnsureFrontendRequestsAreStateful::class, &amp;#39;throttle:api&amp;#39;, \Illuminate\Routing\Middleware\SubstituteBindings::class, ], é…ç½® é‡å†™é»˜è®¤æ¨¡å‹
æ‰§è¡Œè¿ç§»å‘½ä»¤å¾—æ—¶å€™ä¼šç”Ÿæˆapp\Models\PersonalAccessToken.phpæ–‡ä»¶ï¼Œå°½ç®¡é€šå¸¸ä¸éœ€è¦ï¼Œä½†æ‚¨å¯ä»¥è‡ªç”±æ‰©å±• Sanctum å†…éƒ¨ä½¿ç”¨çš„ PersonalAccessToken æ¨¡å‹ã€‚ç”±äºç”Ÿæˆçš„è¡¨åå« personal_access_tokensï¼Œå¼€å‘ä¸­æˆ‘ä»¬ä¹ æƒ¯ç”¨æˆ·è¡¨åå« usersï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†è¡¨åä¿®æ”¹ä¸º user_tokens ã€‚
åˆ›å»º UserToken æ¨¡å‹æ–‡ä»¶ï¼š
php artisan make:model UserToken æ¨¡å‹æ–‡ä»¶ UserToken.php å†…å®¹å¦‚ä¸‹ï¼š</description>
    </item>
    
    <item>
      <title>Laravel å¼€å‘ API åˆå§‹æ­å»º</title>
      <link>https://blog.gookm.cn/posts/2022/20220115-api-init/</link>
      <pubDate>Sat, 15 Jan 2022 00:00:00 +0000</pubDate>
      
      <guid>https://blog.gookm.cn/posts/2022/20220115-api-init/</guid>
      <description>å‰è¨€ ä½¿ç”¨ Laravel å¼€å‘è¿‡ä¸å°‘é¡¹ç›®ï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯å‰åç«¯åˆ†ç¦»çš„ï¼Œæ‰€ä»¥ä»Šå¤©å°±æ€»ç»“å½’çº³ä¸‹åœ¨å¼€å‘APIé¡¹ç›®æ—¶ï¼ŒLaravel çš„å‰æœŸæ¡†æ¶æ­å»ºè¿‡ç¨‹ï¼
ç¯å¢ƒ PHP 8.0.5 (cli) MySQL 8.0.25-0ubuntu0.20.04.1 (Ubuntu) Nginx nginx/1.18.0 (Ubuntu) IDE PhpStorm2020.2 æ­å»º å®‰è£…
//é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬ composer create-project laravel/laravel newapi //æŒ‡å®šç‰ˆæœ¬ composer create-project --prefer-dist laravel/laravel newapi &amp;#34;6.0.*&amp;#34; é…ç½®
æ•°æ®åº“ï¼ˆé…ç½®æ ¹ç›®å½•ä¸‹ .env æ–‡ä»¶ï¼‰
DB_CONNECTION=mysql // hoståœ°å€ DB_HOST=127.0.0.1 // ç«¯å£å· DB_PORT=3306 // æ•°æ®åº“å DB_DATABASE=laravel9 // ç”¨æˆ·å DB_USERNAME=root // å¯†ç  DB_PASSWORD= æ—¶åŒºï¼ˆé…ç½® config/app.php æ–‡ä»¶ï¼‰
&amp;#39;timezone&amp;#39; =&amp;gt; &amp;#39;PRC&amp;#39;, // å¤§é™†æ—¶é—´ å®‰è£…æ‰©å±•åŒ…
åªåˆ—å‡ºé¡¹ç›®å¿…å¤‡çš„å‡ ä¸ªï¼Œå¦‚æœæœ‰éœ€è¦å¯ä»¥ä»ä¸‹é¢é“¾æ¥é‡Œçœ‹ä¸€ä¸‹
ä¸‹è½½é‡æœ€é«˜çš„ 100 ä¸ª Laravel æ‰©å±•åŒ…æ¨è
ä»£ç æç¤ºå·¥å…·(https://github.com/barryvdh/laravel-ide-helper)
//åœ¨ dev ç¯å¢ƒå®‰è£… composer require barryvdh/laravel-ide-helper --dev è¯­è¨€åŒ…(https://github.</description>
    </item>
    
  </channel>
</rss>
